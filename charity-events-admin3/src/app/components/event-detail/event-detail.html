<div class="container mt-4">
  <button class="btn btn-link mb-3" (click)="goBack()">‚Üê Back to List</button>
  <a class="btn btn-link mb-3 ms-2" [routerLink]="['/events']"></a>

  <div *ngIf="loading" class="text-center mt-5">
    <div class="spinner-border" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
  </div>

  <div *ngIf="error" class="alert alert-danger">
    {{ error }}
  </div>

  <div *ngIf="!loading && event">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2>{{ event.title }}</h2>
      <div>
        <button class="btn btn-warning me-2" (click)="editEvent()">Edit</button>
        <button class="btn btn-danger" (click)="deleteEvent()">Delete</button>
      </div>
    </div>

    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Event Details</h5>
        <p><strong>Description:</strong> {{ event.description }}</p>
        <p><strong>Purpose:</strong> {{ event.purpose }}</p>
        <p><strong>Date:</strong> {{ event.start_datetime | date:'yyyy-MM-dd HH:mm' }} - {{ event.end_datetime | date:'yyyy-MM-dd HH:mm' }}</p>
        <p><strong>Venue:</strong> {{ event.venue }}, {{ event.city }}, {{ event.state }}</p>
        <p><strong>Coordinates:</strong> {{ event.latitude }}, {{ event.longitude }}</p>
        <p>
          <strong>Status:</strong>
          <span class="badge ms-2" [ngClass]="{
            'bg-success': event.status === 'upcoming',
            'bg-secondary': event.status === 'paused',
            'bg-info': event.status === 'past'
          }">
            {{ event.status === 'upcoming' ? 'Upcoming' : event.status === 'paused' ? 'Paused' : 'Past' }}
          </span>
        </p>
        <p><strong>Category:</strong> {{ event.category_name }}</p>
        <p><strong>Organization:</strong> {{ event.org_name }}</p>
        <p><strong>Ticket Price:</strong> {{ event.ticket_price_cents / 100 | currency }} {{ event.is_free ? '(Free)' : '' }}</p>
        <p><strong>Target Amount:</strong> {{ event.target_amount_cents / 100 | currency }}</p>
        <p><strong>Raised Amount:</strong> {{ event.raised_amount_cents / 100 | currency }}</p>
        <p *ngIf="event.hero_image_url"><strong>Event Image:</strong> {{ event.hero_image_url }}</p>
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Registration Information ({{ registrations.length }} records)</h5>
        <table class="table table-striped">
          <thead>
            <tr>
              <th>ID</th>
              <th>Name</th>
              <th>Email</th>
              <th>Number of Tickets</th>
              <th>Registration Time</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let registration of registrations">
              <td>{{ registration.id }}</td>
              <td>{{ registration.user_name }}</td>
              <td>{{ registration.contact_email }}</td>
              <td>{{ registration.num_tickets }}</td>
              <td>{{ registration.registration_date | date:'yyyy-MM-dd HH:mm' }}</td>
            </tr>
            <tr *ngIf="registrations.length === 0">
              <td colspan="5" class="text-center">No registration records</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>